#!/usr/bin/env python3
# @author madebycm (2025-01-26)

import os
import sys
import subprocess

def check_docker():
    try:
        subprocess.run(['docker', '--version'], 
                      capture_output=True, check=True)
        return True
    except (subprocess.CalledProcessError, FileNotFoundError):
        return False

def check_requirements():
    try:
        import docker
        import blessed
        return True
    except ImportError:
        return False

def main():
    if not check_docker():
        print("Error: Docker is not installed or not running.")
        print("Please install Docker and ensure it's running.")
        sys.exit(1)
        
    if not check_requirements():
        print("Installing required Python packages...")
        subprocess.run([sys.executable, '-m', 'pip', 'install', '-r', 'requirements.txt'])
        
    from cli import SandboxCLI
    
    try:
        cli = SandboxCLI()
        cli.run()
    except KeyboardInterrupt:
        print("\nExiting...")
        sys.exit(0)
    except Exception as e:
        print(f"Error: {e}")
        sys.exit(1)

if __name__ == "__main__":
    main()